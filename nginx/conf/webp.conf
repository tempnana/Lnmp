########################WebP Support
map $http_accept $load_avif {
    ~image/avif "/wp-content/uploads-webpc/$path.$ext.avif";
}
map $http_accept $load_webp {
    ~image/webp "/wp-content/uploads-webpc/$path.$ext.webp";
}
########################WebP Support
server {
    listen 80;
    #listen [::]:80;
    server_name webp.com ;
    index index.html index.htm index.php default.html default.htm default.php;
    root /home/wwwroot/webp.com;

    include rewrite/none.conf;
    ########################WebP Support
    location ~ /wp-content/(?<path>.+)\.(?<ext>jpe?g|png|gif)$ {
        add_header Vary Accept;
        add_header Cache-Control "private" always;
        expires 365d;
        try_files $load_avif $load_webp $uri =404;
    }
    ########################WebP Support
    #error_page   404   /404.html;

    # Deny access to PHP files in specific directory
    #location ~ /(wp-content|uploads|wp-includes|images)/.*\.php$ { deny all; }

    include enable-php.conf;

    location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
        expires 30d;
    }

    location ~ .*\.(js|css)?$ {
        expires 12h;
    }

    location ~ /.well-known {
        allow all;
    }

    location ~ /\. {
        deny all;
    }

    access_log off;
}
